<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Janis Becker" />

<meta name="date" content="2025-01-08" />

<title>memochange-Tutorial: Break in Persistence</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">memochange-Tutorial: Break in
Persistence</h1>
<h4 class="author">Janis Becker</h4>
<h4 class="date">2025-01-08</h4>



<p>The <code>memochange</code> package can be used for two things:
Checking for a break in persistence and checking for a change in mean.
This vignette presents the functions related to a break in persistence.
This includes <code>BP_estim</code>, <code>cusum_test</code>,
<code>LBI_test</code>, <code>LKSN_test</code>, <code>MR_test</code>,
<code>ratio_test</code>, and <code>pb_sim</code>. Before considering the
usage of these functions, a brief literature review elaborates on their
connection.</p>
<div id="literature-review" class="section level2">
<h2>Literature Review</h2>
<p>The degree of memory is an important determinant of the
characteristics of a time series. For an <span class="math inline">\(I(0)\)</span>, or short-memory, process (e.g.,
AR(1) or ARMA(1,1)), the impact of shocks is short-lived and dies out
quickly. On the other hand, for an <span class="math inline">\(I(1)\)</span>, or difference-stationary, process
such as the random walk, shocks persist infinitely. Thus, any change in
a variable will have an impact on all future realizations. For an <span class="math inline">\(I(d)\)</span>, or long-memory, process with <span class="math inline">\(0&lt;d&lt;1\)</span>, shocks neither die out
quickly nor persist infinitely, but have a hyperbolically decaying
impact. In this case, the current value of a variable depends on past
shocks, but the less so the further these shocks are past.</p>
<p>There are plenty of procedures to determine the memory of a series
(see <span class="citation">Robinson (1995)</span>, <span class="citation">Shimotsu (2010)</span>, among others). However, there
is also the possibility that series exhibit a structural change in
memory, often referred to as a change in persistence. Starting with
<span class="citation">Kim (2000)</span> various procedures have been
proposed to detect these changes and consistently estimate the change
point. <span class="citation">Busetti and Taylor (2004)</span> and <span class="citation">Leybourne and Taylor (2004)</span> suggest approaches
for testing the null of constant <span class="math inline">\(I(0)\)</span> behaviour of the series against the
alternative that a change from either <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> or <span class="math inline">\(I(1)\)</span> to <span class="math inline">\(I(0)\)</span> occurred. However, both approaches
show serious distortions if neither the null nor the alternative is
true, e.g. the series is constant <span class="math inline">\(I(1)\)</span>. In this case the procedures by
<span class="citation">Leybourne et al. (2003)</span> and <span class="citation">Leybourne, Taylor, and Kim (2007)</span> can be applied
as they have the same alternative, but assume constant <span class="math inline">\(I(1)\)</span> behaviour under the null. Again, the
procedures exhibit distortions when neither the null nor the alternative
is true. To remedy this issue, <span class="citation">Harvey, Leybourne,
and Taylor (2006)</span> suggest an approach that entails the same
critical values for constant <span class="math inline">\(I(0)\)</span>
and constant <span class="math inline">\(I(1)\)</span> behavior.
Consequently, it accommodates both, constant <span class="math inline">\(I(0)\)</span> and constant <span class="math inline">\(I(1)\)</span> behavior under the null.</p>
<p>While this earlier work focussed on the <span class="math inline">\(I(0)/I(1)\)</span> framework, more recent
approaches are able to detect changes from <span class="math inline">\(I(d_1)\)</span> to <span class="math inline">\(I(d_2)\)</span> where <span class="math inline">\(d_1\)</span> and <span class="math inline">\(d_2\)</span> are allowed to be non-integers. <span class="citation">Sibbertsen and Kruse (2009)</span> extend the approach
of <span class="citation">Leybourne, Taylor, and Kim (2007)</span> such
that the testing procedure consistently detects changes from <span class="math inline">\(0 \leq d_1&lt;1/2\)</span> to <span class="math inline">\(1/2&lt;d_2&lt;3/2\)</span> and vice versa. Under
the null the test assumes constant <span class="math inline">\(I(d)\)</span> behavior with <span class="math inline">\(0 \leq d &lt;3/2\)</span>. The approach suggested
by <span class="citation">Martins and Rodrigues (2014)</span> is even
able to identify changes from <span class="math inline">\(-1/2&lt;d_1&lt;2\)</span> to <span class="math inline">\(-1/2&lt;d_2&lt;2\)</span> with <span class="math inline">\(d_1 \neq d_2\)</span>. Here, under the null the
test assumes constant <span class="math inline">\(I(d)\)</span> behavior
with <span class="math inline">\(-1/2&lt;d&lt;2\)</span>.</p>
<p>Examples for series that potentially exhibit breaks in persistence
are macroeconomic and financial time series such as inflation rates,
trading volume, interest rates, volatilities and so on. For these series
it is therefore strongly recommended to investigate the possibility of a
break in persistence before modeling and forecasting the series.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>The <code>memochange</code> package contains all procedure mentioned
above to identify whether a time series exhibits a break in persistence
mentioned above. Additionally, several estimators are implemented which
consistently estimate the point at which the series exhibits a break in
persistence and the order of integration in the two regimes. We will now
show how the usage of the implemented procedures while investigating the
price of crude oil.</p>
<p>First, we download the monthly price series from the FRED data
base.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>oil<span class="ot">=</span>data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="st">&quot;https://fred.stlouisfed.org/graph/fredgraph.csv?bgcolor=%23e1e9f0&amp;chart_type=line&amp;drp=0&amp;fo=open%20sans&amp;graph_bgcolor=%23ffffff&amp;height=450&amp;mode=fred&amp;recession_bars=on&amp;txtcolor=%23444444&amp;ts=12&amp;tts=12&amp;width=1168&amp;nt=0&amp;thu=0&amp;trc=0&amp;show_legend=yes&amp;show_axis_titles=yes&amp;show_tooltip=yes&amp;id=MCOILWTICO&amp;scale=left&amp;cosd=1986-01-01&amp;coed=2019-08-01&amp;line_color=%234572a7&amp;link_values=false&amp;line_style=solid&amp;mark_type=none&amp;mw=3&amp;lw=2&amp;ost=-99999&amp;oet=99999&amp;mma=0&amp;fml=a&amp;fq=Monthly&amp;fam=avg&amp;fgst=lin&amp;fgsnd=2009-06-01&amp;line_index=1&amp;transformation=lin&amp;vintage_date=2019-09-23&amp;revision_date=2019-09-23&amp;nd=1986-01-01&quot;</span>)</span></code></pre></div>
<p>To get a first visual impression, we plot the series.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>oil<span class="ot">=</span><span class="fu">as.data.frame</span>(oil)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>oil<span class="sc">$</span>observation_date<span class="ot">=</span>zoo<span class="sc">::</span><span class="fu">as.Date</span>(oil<span class="sc">$</span>observation_date)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>oil_xts<span class="ot">=</span>xts<span class="sc">::</span><span class="fu">xts</span>(oil[,<span class="sc">-</span><span class="dv">1</span>],<span class="at">order.by =</span> oil<span class="sc">$</span>observation_date)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>zoo<span class="sc">::</span><span class="fu">plot.zoo</span>(oil_xts, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Price&quot;</span>, <span class="at">main=</span><span class="st">&quot;Crude Oil Price: West Texas Intermediate&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>From the plot we observe that the series seems to be more variable in
its second part from year 2000 onwards. This is first evidence that a
change in persistence has occurred. We can test this hypothesis using
the functions <code>cusum_test</code> (<span class="citation">Leybourne,
Taylor, and Kim (2007)</span>, <span class="citation">Sibbertsen and
Kruse (2009)</span>) <code>LBI_test</code> (<span class="citation">Busetti and Taylor (2004)</span>),
<code>LKSN_test</code> (<span class="citation">Leybourne et al.
(2003)</span>), <code>MR_test</code> (<span class="citation">Martins and
Rodrigues (2014)</span>) , and <code>ratio_test</code> (<span class="citation">Busetti and Taylor (2004)</span>, <span class="citation">Leybourne and Taylor (2004)</span>, <span class="citation">Harvey, Leybourne, and Taylor (2006)</span>). In this
vignette we use the ratio and MR test since these are the empirically
most often applied ones. The functionality of the other tests is
similar. They all require a univariate numeric vector <code>x</code> as
an input variable and yield a matrix of test statistic and critical
values as an output variable.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(memochange)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(oil[,<span class="dv">2</span>])</span></code></pre></div>
<p>As a starting point the default version of the ratio test is
applied.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ratio_test</span>(x)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;                                        90%    95%    99% Teststatistic</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Against change from I(0) to I(1)    3.5148 4.6096 7.5536    225.943543</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; Against change from I(1) to I(0)    3.5588 4.6144 7.5304      1.170217</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction 4.6144 5.7948 9.0840    225.943543</span></span></code></pre></div>
<p>This yields a matrix that gives test statistic and critical values
for the null of constant <span class="math inline">\(I(0)\)</span>
against a change from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> or vice versa. Furthermore, the
statistics for a change in an unknown direction are included as well.
This accounts for the fact that we perform two tests facing a multiple
testing problem. The results suggest that a change from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> has occurred somewhere in the series
since the test statistic exceeds the critical value at the one percent
level. In addition, this value is also significant when accounting for
the multiple testing problem. Consequently, the default version of the
ratio test suggests a break in persistence.</p>
<p>We can modify this default version by choosing the arguments
<code>trend</code>, <code>tau</code>, <code>statistic</code>,
<code>type</code>, <code>m</code>, <code>z</code>, <code>simu</code>,
and <code>M</code> (see the help page of the ratio test for details).
The plot does not indicate a linear trend so that it seems unreasonable
to change the trend argument. Also, the plot suggests that the break is
rather in the middle of the series than at the beginning or the end so
that changing <code>tau</code> seems unnecessary as well. The type of
test statistic calculated can be easily changed using the statistic
argument. However, simulation results indicate mean, max, and exp
statistics to deliver qualitatively similar results.</p>
<p>Something that is of more importance is the type of test performed.
The default version considers the approach by Busetti and Taylor (2004).
In case of a constant <span class="math inline">\(I(1)\)</span> process
this test often spuriously identifies a break in persistence. Harvey,
Leybourne and Taylor (2006) account for this issue by adjusting the test
statistic such that its critical values are the same under constant
<span class="math inline">\(I(0)\)</span> and constant <span class="math inline">\(I(1)\)</span>. We can calculate their test
statistic by setting <code>type=&quot;HLT&quot;</code>. For this purpose, we need
to state the number of polynomials <code>z</code> used in their test
statistic. The default value is 9 as suggested by Harvey, Leybourne and
Taylor (2006). Choosing another value is only sensible for very large
data sets (number of obs. &gt; 10000) where the test statistic cannot be
calculated due to computational singularity. In this case decreasing
<code>z</code> can allow the test statistic to be calculated. This
invalidates the critical values so that we would have to simulate them
by setting <code>simu=1</code>. However, as our data set is rather small
we can stick with the default of <code>z=9</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ratio_test</span>(x, <span class="at">type=</span><span class="st">&quot;HLT&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;                                        90%    95%    99% Teststatistic 90%</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; Against change from I(0) to I(1)    3.5148 4.6096 7.5536        58.9102128</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Against change from I(1) to I(0)    3.5588 4.6144 7.5304         0.3085619</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction 4.6144 5.7948 9.0840        44.2193169</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;                                     Teststatistic 95% Teststatistic 99%</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; Against change from I(0) to I(1)           43.4794337        25.3386256</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; Against change from I(1) to I(0)            0.2290226         0.1290391</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction        34.1387057        20.0073212</span></span></code></pre></div>
<p>Again the test results suggests that there is a break from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span>. Consequently, it is not a constant
<span class="math inline">\(I(1)\)</span> process that led to a spurious
rejection of the test by Busetti and Taylor (2004).</p>
<p>Another test for a change in persistence is that by Martins and
Rodrigues (2014). This is more general as it is not restricted to the
<span class="math inline">\(I(0)/I(1)\)</span> framework, but can
identify changes from <span class="math inline">\(I(d_1)\)</span> to
<span class="math inline">\(I(d_2)\)</span> with <span class="math inline">\(d_1 \neq d_2\)</span> and <span class="math inline">\(-1/2&lt;d_1,d_2&lt;2\)</span>. The default version
is applied by</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">MR_test</span>(x)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;                                          90%      95%      99% Teststatistic</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; Against increase in memory          4.270666 5.395201 8.233674      16.21494</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; Against decrease in memory          4.060476 5.087265 7.719128       2.14912</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction 5.065695 6.217554 9.136441      16.21494</span></span></code></pre></div>
<p>Again, the function returns a matrix consisting of test statistic and
critical values. Here, the alternative of the test is an increase
respectively a decrease in memory. In line with the results of the ratio
test, the approach by Martins and Rodrigues (2014) suggests that the
series exhibits an increase in memory, i.e. that the memory of the
series increases from <span class="math inline">\(d_1\)</span> to <span class="math inline">\(d_2\)</span> with <span class="math inline">\(d_1&lt;d_2\)</span> at some point in time. Again,
this also holds if we consider the critical values that account for the
multiple testing problem.</p>
<p>Similar to the ratio test and all other tests against a change in
persistence in the <code>memochange</code> package, the MR test also has
the same arguments <code>trend</code>, <code>tau</code>,
<code>simu</code>, and <code>M</code>. Furthermore, we can choose again
the type of test statistic. This time we can decide whether to use the
squared t-statistic or the standard t-statistic.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">MR_test</span>(x, <span class="at">statistic=</span><span class="st">&quot;standard&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;                                           90%       95%       99% Teststatistic</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Against increase in memory          -1.637306 -1.920434 -2.504862     -2.880545</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; Against decrease in memory          -1.651586 -1.951420 -2.514165     -1.277410</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction -1.933137 -2.203370 -2.722017     -2.880545</span></span></code></pre></div>
<p>As for the ratio test, changing the type of statistic has a rather
small effect on the empirical performance of the test.</p>
<p>If we believe that the underlying process exhibits additional short
run components, we can account for these by setting
<code>serial=TRUE</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">MR_test</span>(x, <span class="at">serial=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by &#39;quantmod&#39;:</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;   method            from</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;                                          90%      95%      99% Teststatistic</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Against increase in memory          4.270666 5.395201 8.233674     10.727202</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Against decrease in memory          4.060476 5.087265 7.719128      6.758906</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Against change in unknown direction 5.065695 6.217554 9.136441     10.727202</span></span></code></pre></div>
<p>While the test statistic changes, the conclusion remains the
same.</p>
<p>All tests indicate that the oil price series exhibits an increase in
memory over time. To correctly model and forecast the series, the exact
location of the break is important. This can be estimated by the
<code>BP_estim</code> function. It is important for the function that
the direction of the change is correctly specified. In our case, an
increase in memory has occurred so that we set
<code>direction=&quot;01&quot;</code></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">BP_estim</span>(x, <span class="at">direction=</span><span class="st">&quot;01&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; $Breakpoint</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; [1] 151</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; $d_1</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.8127501</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; $sd_1</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.08574929</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; $d_2</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; [1] 1.088039</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; $sd_2</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.07142857</span></span></code></pre></div>
<p>This yields a list stating the location of the break (observation
151), semiparametric estimates of the order of integration in the two
regimes (0.86 and 1.03) as well as the standard deviations of these
estimates (0.13 and 0.15).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>oil<span class="sc">$</span>DATE[<span class="dv">151</span>]</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Consequently, the function indicates that there is a break in
persistence in July, 1998. This means that from the beginning of the
sample until June 1998 the series is integrated with an order of 0.85
and from July 1998 on the order of integration increased to 1.03.</p>
<p>As before, the function allows for various types of break point
estimators. Instead of the default estimator of Busetti and Taylor
(2004), one can also rely on the estimator of Leybourne, Kim, and Taylor
(2007) by setting <code>type=&quot;LKT&quot;</code>. This estimator relies on
estimates of the long-run variance. Therefore, it is also needed that
<code>m</code> is chosen, which determines how many covariances are used
when estimating the long-run variance. Leybourne, Kim, and Taylor (2007)
suggest <code>m=0</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">BP_estim</span>(x, <span class="at">direction=</span><span class="st">&quot;01&quot;</span>, <span class="at">type=</span><span class="st">&quot;LKT&quot;</span>, <span class="at">m=</span><span class="dv">0</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; $Breakpoint</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; [1] 148</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; $d_1</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.7660609</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; $sd_1</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.08703883</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; $d_2</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; [1] 1.067404</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; $sd_2</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.07142857</span></span></code></pre></div>
<p>This yields a similar result with the break point lying in the year
1998 and d increasing from approximately 0.8 to approximately 1.</p>
<p>All other arguments of the function (<code>trend</code>,
<code>tau</code>, <code>serial</code>) were already discussed above
except for <code>d_estim</code> and <code>d_bw</code>. These two
arguments determine which estimator and bandwidth are used to estimate
the order of integration in the two regimes. Concerning the estimator,
the GPH (Geweke and Porter-Hudak (1983)) and the exact local Whittle
estimator (Shimotsu and Phillips (2005)) can be selected. Although the
exact local Whittle estimator has a lower variance, the GPH estimator is
still often considered in empirical applications due to its simplicity.
In our example the results of the two estimators are almost
identical.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">BP_estim</span>(x, <span class="at">direction=</span><span class="st">&quot;01&quot;</span>, <span class="at">d_estim=</span><span class="st">&quot;GPH&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; $Breakpoint</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1] 151</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; $d_1</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.855238</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; $sd_1</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.129834</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; $d_2</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [1] 1.034389</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; $sd_2</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.1468516</span></span></code></pre></div>
<p>The <code>d_bw</code> argument determines how many frequencies are
used for estimation. Larger values imply a lower variance of the
estimates, but also bias the estimator if the underlying process
possesses short run dynamics. Usually a value between 0.5 and 0.8 is
considered.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">BP_estim</span>(x, <span class="at">direction=</span><span class="st">&quot;01&quot;</span>, <span class="at">d_bw=</span><span class="fl">0.75</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; $Breakpoint</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; [1] 151</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; $d_1</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.9146951</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; $sd_1</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; [1] 0.07624929</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; $d_2</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; [1] 1.173524</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; $sd_2</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.0625</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="fu">BP_estim</span>(x, <span class="at">direction=</span><span class="st">&quot;01&quot;</span>, <span class="at">d_bw=</span><span class="fl">0.65</span>)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; $Breakpoint</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; [1] 151</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; $d_1</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; [1] 0.5803242</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; $sd_1</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; [1] 0.09805807</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; $d_2</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; [1] 0.9353325</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; $sd_2</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; [1] 0.08219949</span></span></code></pre></div>
<p>In our setup, it can be seen that increasing <code>d_bw</code> to
0.75 does not severely change the estimated order of integration in the
two regimes. Decreasing <code>d_bw</code>, however, leads to smaller
estimates of <span class="math inline">\(d\)</span>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-busetti2004tests" class="csl-entry">
Busetti, Fabio, and AM Robert Taylor. 2004. <span>“Tests of Stationarity
Against a Change in Persistence.”</span> <em>Journal of
Econometrics</em> 123 (1): 33–66. <a href="https://doi.org/10.1016/j.jeconom.2003.10.028">https://doi.org/10.1016/j.jeconom.2003.10.028</a>.
</div>
<div id="ref-harvey2006modified" class="csl-entry">
Harvey, David I, Stephen Leybourne, and AM Robert Taylor. 2006.
<span>“Modified Tests for a Change in Persistence.”</span> <em>Journal
of Econometrics</em> 134 (2): 441–69. <a href="https://doi.org/10.1016/j.jeconom.2005.07.002">https://doi.org/10.1016/j.jeconom.2005.07.002</a>.
</div>
<div id="ref-kim2000detection" class="csl-entry">
Kim, Jae-Young. 2000. <span>“Detection of Change in Persistence of a
Linear Time Series.”</span> <em>Journal of Econometrics</em> 95 (1):
97–116. <a href="https://doi.org/10.1016/S0304-4076(99)00031-7">https://doi.org/10.1016/S0304-4076(99)00031-7</a>.
</div>
<div id="ref-leybourne2003tests" class="csl-entry">
Leybourne, Stephen, Tae-Hwan Kim, Vanessa Smith, and Paul Newbold. 2003.
<span>“Tests for a Change in Persistence Against the Null of
Difference-Stationarity.”</span> <em>The Econometrics Journal</em> 6
(2): 291–311. <a href="https://doi.org/10.1111/1368-423X.t01-1-00110">https://doi.org/10.1111/1368-423X.t01-1-00110</a>.
</div>
<div id="ref-leybourne2004tests" class="csl-entry">
Leybourne, Stephen, and AM Robert Taylor. 2004. <span>“On Tests for
Changes in Persistence.”</span> <em>Economics Letters</em> 84 (1):
107–15. <a href="https://doi.org/10.1016/j.econlet.2003.12.015">https://doi.org/10.1016/j.econlet.2003.12.015</a>.
</div>
<div id="ref-leybourne2007cusum" class="csl-entry">
Leybourne, Stephen, Robert Taylor, and Tae-Hwan Kim. 2007. <span>“CUSUM
of Squares-Based Tests for a Change in Persistence.”</span> <em>Journal
of Time Series Analysis</em> 28 (3): 408–33. <a href="https://doi.org/10.1111/j.1467-9892.2006.00517.x">https://doi.org/10.1111/j.1467-9892.2006.00517.x</a>.
</div>
<div id="ref-martins2014testing" class="csl-entry">
Martins, Luis F, and Paulo MM Rodrigues. 2014. <span>“Testing for
Persistence Change in Fractionally Integrated Models: An Application to
World Inflation Rates.”</span> <em>Computational Statistics &amp; Data
Analysis</em> 76: 502–22. <a href="https://doi.org/10.1016/j.csda.2012.07.021">https://doi.org/10.1016/j.csda.2012.07.021</a>.
</div>
<div id="ref-robinson1995gaussian" class="csl-entry">
Robinson, Peter M. 1995. <span>“Gaussian Semiparametric Estimation of
Long Range Dependence.”</span> <em>The Annals of Statistics</em> 23 (5):
1630–61. <a href="https://doi.org/10.1214/aos/1176324317">https://doi.org/10.1214/aos/1176324317</a>.
</div>
<div id="ref-shimotsu2010exact" class="csl-entry">
Shimotsu, Katsumi. 2010. <span>“Exact Local Whittle Estimation of
Fractional Integration with Unknown Mean and Time Trend.”</span>
<em>Econometric Theory</em> 26 (2): 501–40. <a href="https://doi.org/10.1017/S0266466609100075">https://doi.org/10.1017/S0266466609100075</a>.
</div>
<div id="ref-sibbertsen2009testing" class="csl-entry">
Sibbertsen, Philipp, and Robinson Kruse. 2009. <span>“Testing for a
Break in Persistence Under Long-Range Dependencies.”</span> <em>Journal
of Time Series Analysis</em> 30 (3): 263–85. <a href="https://doi.org/10.1111/j.1467-9892.2009.00611.x">https://doi.org/10.1111/j.1467-9892.2009.00611.x</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
